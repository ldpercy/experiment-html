<!doctype html>
<html lang="en">
<head>
	<title>Dynamic Load JS</title>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">

	<!-- core items -->
	<link rel="stylesheet" href="../style/default.css">
	<script defer src="../util/util.js"></script>
	<script defer src="dynamic-load.js"></script>

	<!--- changeSrc doesn't work, no events are triggered --->
	<script
		defer
		id="changeSrc"
		onload="log('changeSrc: onload');"
		onreadystatechange="log('changeSrc: onreadystatechange');"
		>
	</script>

	<!-- replaceScript -->
	<script
		defer
		id="repscr-123"
		onload="log('replaceScript: onload');"
		onreadystatechange="log('replaceScript: onreadystatechange');"
		>
	</script>

</head>
<body onload="bodyOnload();">
	<div class="navigate-up"><a  title="Up to folder" href="./">./</a> <a  title="Parent folder" href="../">../</a></div>

	<h1><a href="index.html">Dynamic Load JS</a></h1>

	<h2>Load page with parameter:</h2>
	<ul>
		<li><a href="index.html?scriptname=foobar">index.html?scriptname=foobar</a></li>
		<li><a href="index.html?scriptname=abc">index.html?scriptname=abc</a></li>
		<li><a href="index.html?scriptname=def">index.html?scriptname=def</a></li>
		<li><a href="index.html?scriptname=;--malicious*script">index.html?scriptname=;--malicious*script</a></li>
	</ul>

	<h2>Replace script - local callback</h2>
	<p>
		<button onclick="replaceScript('repscr-123', '', ()=>(scriptOnload('empty')) )">
			src attribute ''
		</button>
		<button onclick="replaceScript('repscr-123', 'script/abc.js', () => (scriptOnload('abc')))">
			abc/script.js
		</button>
		<button onclick="replaceScript('repscr-123', 'script/def.js', () => (scriptOnload('def')))">
			def/script.js
		</button>
	</p>
	<h2>Replace script - remote callback</h2>
	<p>
		<button onclick="replaceScript('repscr-123', '', ()=>(scriptAnnounce()) )">
			src attribute ''
		</button>
		<button onclick="replaceScript('repscr-123', 'script/abc.js', ()=>(scriptAnnounce()) )">
			abc/script.js
		</button>
		<button onclick="replaceScript('repscr-123', 'script/def.js', ()=>(scriptAnnounce()) )">
			def/script.js
		</button>
	</p>

	<h2>Append script:</h2>
	<p>
		<button onclick="appendScript('', ()=>(scriptAnnounce()) )">
			src attribute ''
		</button>
		<button onclick="appendScript('script/abc.js', ()=>(scriptAnnounce()) )">
			abc/script.js
		</button>
		<button onclick="appendScript('script/def.js', ()=>(scriptAnnounce()) )">
			def/script.js
		</button>
	</p>

	<h2>Change src (doesn't work):</h2>
	<p>
		<button onclick="changeSrc('script/placeholder.js', () => (scriptOnload('empty')) )">
			script/placeholder.js
		</button>
		<button onclick="changeSrc('script/abc.js', () => (scriptOnload('abc')) )">
			abc/script.js
		</button>
		<button onclick="changeSrc('script/def.js', () => (scriptOnload('abc')) )">
			def/script.js
		</button>
	</p>

	<h2>Log:</h2>
	<pre class="log" id="prelog"></pre>

</body>
</html>