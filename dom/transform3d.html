<!doctype html>
<html lang="en">
<head>
	<title>transform 3d</title>
	<meta charset="utf-8">
	<link rel="icon" href="../[common]/favicon.svg">
	<link rel="stylesheet" href="../[common]/common-style.css">
	<link rel="stylesheet" href="../[common]/form.css">

</head>
<body>
	<header>
		<nav>
			<a id="button-lightScheme" href="#" title="Light scheme" data-scheme="light">ðŸŸ“</a>
			<a id="button-darkScheme" href="#" title="Dark scheme" data-scheme="dark">ðŸŸ’</a>
			<a title="To folder" href="./">ðŸ–¿</a>
			<a title="Parent folder" href="../">ðŸ¡…</a>
		</nav>

		<h1><a href="">transform 3d</a></h1>
	</header>

	<link rel="stylesheet" href="../[html-common]/style/svg/grid.css"/>

	<main>

		<style contenteditable="plaintext-only" spellcheck="false" class="limit-height">
			* { transition: all ease-in 0.5s; }
			svg {
				outline:2px dashed var(--svg-orange);
				margin:1ex;
				border-radius: 1ex;
			}

			main {
				display:grid;
				grid-template-columns: 1fr 1fr 1fr 1fr;

				style, script {
					grid-column-start: span 2;
				}

				.limit-height {
					max-height:30em;
					overflow-y: scroll;
				}
			}

			@media (orientation: landscape) {
				main { grid-template-columns: 1fr 1fr 1fr 1fr; }
				output { grid-column-start: span 3; }
				form { grid-column-start: span 1; }
			}

			@media (orientation: portrait) {
				main { grid-template-columns: 1fr 1fr ; }
				output { grid-column-start: span 2; }
				form { grid-column-start: span 2; }
			}
		</style>

		<script type="module">
			import * as planar from '../[html-common]/module/PlanarSpace.js'
			import * as svg from '../[html-common]/module/SVG.js'

			let space = new planar.Space('simple space');
			let box = new svg.Box(-1200,-600,2400,1200);
			//console.log(box);

			const cartesianGrid = new svg.CartesianGrid(space, box);
			const svgGrid = document.getElementById('svgGrid');
			svgGrid.innerHTML = cartesianGrid.toString();

		</script>

		<output>
			<svg id="svgDoc1" viewBox="-1200 -600 2400 1200">
				<g>
					<g id="svgGrid" class="grid"></g>
					<polyline points="100,-100 400,-300 400,-100" style="stroke:red;stroke-width:10px;fill:#f007;"/>
				</g>
			</svg>
			<!-- <div id="transform-element">
				lipsum dolor sit amet
			</div> -->
		</output>
		<form name="matrix" onchange="formOnchange()">

			<h2>mutators</h2>

			<label><input name="rotateX" type="number" value="0" step="15"> rotateX </label>
			<label><input name="rotateY" type="number" value="0" step="15"> rotateY </label>
			<label><input name="rotateZ" type="number" value="0" step="15"> rotateZ </label>

			<label>
				<input type="checkbox" name="invert"> invert
			</label>

			<button type="reset" onclick="formReset()">reset</button>
		</form>



		<script>
			const transformElement = document.getElementById('svgDoc1');


			function formOnchange() {
				//console.log('formOnchange')
				let matrix = new DOMMatrix();

				matrix.rotateSelf(
					document.forms.matrix.rotateX.value,
					document.forms.matrix.rotateY.value,
					document.forms.matrix.rotateZ.value,
				);

				if (document.forms.matrix.invert.checked) {
					matrix.invertSelf();
				}

				console.log(matrix);
				transformElement.style.setProperty('transform', matrix.toString());

			}

			const identity = new DOMMatrixReadOnly([
				1, 0, 0,
				1, 0, 0,
			]);

			function formReset() {
				console.log('formReset');
				transformElement.style.setProperty('transform', '');
			}



		</script>

		<!--


			/* 2D */
			const point2D = new DOMPointReadOnly(50, 50);

			/* 3D */
			const point3D = new DOMPointReadOnly(50, 50, 25);

			/* 3D with perspective */
			const point3DPerspective = new DOMPointReadOnly(100, 100, 100, 1.0);

			const point = new DOMPoint(5, 4);
			const scaleX = 2;
			const scaleY = 3;
			const translateX = 12;
			const translateY = 8;
			const angle = Math.PI / 2;
			const matrix = new DOMMatrix([
				Math.cos(angle) * scaleX,
				Math.sin(angle) * scaleX,
				-Math.sin(angle) * scaleY,
				Math.cos(angle) * scaleY,
				translateX,
				translateY,
			]);
			const transformedPoint = point.matrixTransform(matrix);

			//console.log(matrix);
			//console.log(transformedPoint);
			function logTransform(p,matrix) { console.dir(p, p.matrixTransform(matrix)); }
		-->


	</main>


</body>
</html>